{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "django__django-17087", "model_patch": "diff --git a/django/db/migrations/serializer.py b/django/db/migrations/serializer.py\nindex d88cda6e20..06657ebaab 100644\n--- a/django/db/migrations/serializer.py\n+++ b/django/db/migrations/serializer.py\n@@ -168,7 +168,7 @@ class FunctionTypeSerializer(BaseSerializer):\n         ):\n             klass = self.value.__self__\n             module = klass.__module__\n-            return \"%s.%s.%s\" % (module, klass.__name__, self.value.__name__), {\n+            return \"%s.%s.%s\" % (module, klass.__qualname__, self.value.__name__), {\n                 \"import %s\" % module\n             }\n         # Further error checking\ndiff --git a/tests/migrations/test_writer.py b/tests/migrations/test_writer.py\nindex bef8f64061..21b23ac0ee 100644\n--- a/tests/migrations/test_writer.py\n+++ b/tests/migrations/test_writer.py\n@@ -52,6 +52,18 @@ class TestModel1:\n     thing = models.FileField(upload_to=upload_to)\n \n \n+class TestModel3:\n+    class NestedClass:\n+        @classmethod\n+        def nested_method(cls):\n+            return \"nested\"\n+        \n+        class DeeplyNestedClass:\n+            @classmethod\n+            def deeply_nested_method(cls):\n+                return \"deeply_nested\"\n+\n+\n class TextEnum(enum.Enum):\n     A = \"a-value\"\n     B = \"value-b\"\n@@ -753,6 +765,19 @@ class WriterTests(SimpleTestCase):\n         ):\n             self.serialize_round_trip(TestModel2.thing)\n \n+    def test_serialize_nested_class_method(self):\n+        \"\"\"Nested class methods should use __qualname__ for correct serialization.\"\"\"\n+        \n+        # Test nested class method\n+        string, imports = MigrationWriter.serialize(TestModel3.NestedClass.nested_method)\n+        self.assertEqual(string, \"migrations.test_writer.TestModel3.NestedClass.nested_method\")\n+        self.assertEqual(imports, {\"import migrations.test_writer\"})\n+        \n+        # Test deeply nested class method\n+        string, imports = MigrationWriter.serialize(TestModel3.NestedClass.DeeplyNestedClass.deeply_nested_method)\n+        self.assertEqual(string, \"migrations.test_writer.TestModel3.NestedClass.DeeplyNestedClass.deeply_nested_method\")\n+        self.assertEqual(imports, {\"import migrations.test_writer\"})\n+\n     def test_serialize_managers(self):\n         self.assertSerializedEqual(models.Manager())\n         self.assertSerializedResultEqual(\n"}