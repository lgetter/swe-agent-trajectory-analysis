{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "sympy__sympy-21612", "model_patch": "diff --git a/conftest.py b/conftest.py\ndeleted file mode 100644\nindex 3397cb3b1e..0000000000\n--- a/conftest.py\n+++ /dev/null\n@@ -1,70 +0,0 @@\n-# -*- coding: utf-8 -*-\n-\n-from __future__ import print_function, division, absolute_import\n-\n-import os\n-from itertools import chain\n-import json\n-import sys\n-import warnings\n-import pytest\n-from sympy.testing.runtests import setup_pprint, _get_doctest_blacklist\n-\n-durations_path = os.path.join(os.path.dirname(__file__), '.ci', 'durations.json')\n-blacklist_path = os.path.join(os.path.dirname(__file__), '.ci', 'blacklisted.json')\n-\n-# Collecting tests from rubi_tests under pytest leads to errors even if the\n-# tests will be skipped.\n-collect_ignore = [\"sympy/integrals/rubi\"] + _get_doctest_blacklist()\n-\n-# Set up printing for doctests\n-setup_pprint()\n-sys.__displayhook__ = sys.displayhook\n-#from sympy import pprint_use_unicode\n-#pprint_use_unicode(False)\n-\n-\n-def _mk_group(group_dict):\n-    return list(chain(*[[k+'::'+v for v in files] for k, files in group_dict.items()]))\n-\n-if os.path.exists(durations_path):\n-    veryslow_group, slow_group = [_mk_group(group_dict) for group_dict in json.loads(open(durations_path, 'rt').read())]\n-else:\n-    # warnings in conftest has issues: https://github.com/pytest-dev/pytest/issues/2891\n-    warnings.warn(\"conftest.py:22: Could not find %s, --quickcheck and --veryquickcheck will have no effect.\\n\" % durations_path)\n-    veryslow_group, slow_group = [], []\n-\n-if os.path.exists(blacklist_path):\n-    blacklist_group = _mk_group(json.loads(open(blacklist_path, 'rt').read()))\n-else:\n-    warnings.warn(\"conftest.py:28: Could not find %s, no tests will be skipped due to blacklisting\\n\" % blacklist_path)\n-    blacklist_group = []\n-\n-\n-def pytest_addoption(parser):\n-    parser.addoption(\"--quickcheck\", dest=\"runquick\", action=\"store_true\",\n-                     help=\"Skip very slow tests (see ./ci/parse_durations_log.py)\")\n-    parser.addoption(\"--veryquickcheck\", dest=\"runveryquick\", action=\"store_true\",\n-                     help=\"Skip slow & very slow (see ./ci/parse_durations_log.py)\")\n-\n-\n-def pytest_configure(config):\n-    # register an additional marker\n-    config.addinivalue_line(\"markers\", \"slow: manually marked test as slow (use .ci/durations.json instead)\")\n-    config.addinivalue_line(\"markers\", \"quickcheck: skip very slow tests\")\n-    config.addinivalue_line(\"markers\", \"veryquickcheck: skip slow & very slow tests\")\n-\n-\n-def pytest_runtest_setup(item):\n-    if isinstance(item, pytest.Function):\n-        if item.nodeid in veryslow_group and (item.config.getvalue(\"runquick\") or\n-                                              item.config.getvalue(\"runveryquick\")):\n-            pytest.skip(\"very slow test, skipping since --quickcheck or --veryquickcheck was passed.\")\n-            return\n-        if item.nodeid in slow_group and item.config.getvalue(\"runveryquick\"):\n-            pytest.skip(\"slow test, skipping since --veryquickcheck was passed.\")\n-            return\n-\n-        if item.nodeid in blacklist_group:\n-            pytest.skip(\"blacklisted test, see %s\" % blacklist_path)\n-            return\ndiff --git a/isympy.py b/isympy.py\ndeleted file mode 100644\nindex 7d9e4e6bb8..0000000000\n--- a/isympy.py\n+++ /dev/null\n@@ -1,342 +0,0 @@\n-\"\"\"\n-Python shell for SymPy.\n-\n-This is just a normal Python shell (IPython shell if you have the\n-IPython package installed), that executes the following commands for\n-the user:\n-\n-    >>> from __future__ import division\n-    >>> from sympy import *\n-    >>> x, y, z, t = symbols('x y z t')\n-    >>> k, m, n = symbols('k m n', integer=True)\n-    >>> f, g, h = symbols('f g h', cls=Function)\n-    >>> init_printing()\n-\n-So starting 'isympy' is equivalent to starting Python (or IPython) and\n-executing the above commands by hand.  It is intended for easy and quick\n-experimentation with SymPy.  isympy is a good way to use SymPy as an\n-interactive calculator. If you have IPython and Matplotlib installed, then\n-interactive plotting is enabled by default.\n-\n-COMMAND LINE OPTIONS\n---------------------\n-\n--c CONSOLE, --console=CONSOLE\n-\n-     Use the specified shell (Python or IPython) shell as the console\n-     backend instead of the default one (IPython if present, Python\n-     otherwise), e.g.:\n-\n-        $isympy -c python\n-\n-    CONSOLE must be one of 'ipython' or 'python'\n-\n--p PRETTY, --pretty PRETTY\n-\n-    Setup pretty-printing in SymPy. When pretty-printing is enabled,\n-    expressions can be printed with Unicode or ASCII. The default is\n-    to use pretty-printing (with Unicode if the terminal supports it).\n-    When this option is 'no', expressions will not be pretty-printed\n-    and ASCII will be used:\n-\n-        $isympy -p no\n-\n-    PRETTY must be one of 'unicode', 'ascii', or 'no'\n-\n--t TYPES, --types=TYPES\n-\n-    Setup the ground types for the polys.  By default, gmpy ground types\n-    are used if gmpy2 or gmpy is installed, otherwise it falls back to python\n-    ground types, which are a little bit slower.  You can manually\n-    choose python ground types even if gmpy is installed (e.g., for\n-    testing purposes):\n-\n-        $isympy -t python\n-\n-    TYPES must be one of 'gmpy', 'gmpy1' or 'python'\n-\n-    Note that the ground type gmpy1 is primarily intended for testing; it\n-    forces the use of gmpy version 1 even if gmpy2 is available.\n-\n-    This is the same as setting the environment variable\n-    SYMPY_GROUND_TYPES to the given ground type (e.g.,\n-    SYMPY_GROUND_TYPES='gmpy')\n-\n-    The ground types can be determined interactively from the variable\n-    sympy.polys.domains.GROUND_TYPES.\n-\n--o ORDER, --order ORDER\n-\n-    Setup the ordering of terms for printing.  The default is lex, which\n-    orders terms lexicographically (e.g., x**2 + x + 1). You can choose\n-    other orderings, such as rev-lex, which will use reverse\n-    lexicographic ordering (e.g., 1 + x + x**2):\n-\n-        $isympy -o rev-lex\n-\n-    ORDER must be one of 'lex', 'rev-lex', 'grlex', 'rev-grlex',\n-    'grevlex', 'rev-grevlex', 'old', or 'none'.\n-\n-    Note that for very large expressions, ORDER='none' may speed up\n-    printing considerably but the terms will have no canonical order.\n-\n--q, --quiet\n-\n-    Print only Python's and SymPy's versions to stdout at startup.\n-\n--d, --doctest\n-\n-    Use the same format that should be used for doctests.  This is\n-    equivalent to -c python -p no.\n-\n--C, --no-cache\n-\n-    Disable the caching mechanism.  Disabling the cache may slow certain\n-    operations down considerably.  This is useful for testing the cache,\n-    or for benchmarking, as the cache can result in deceptive timings.\n-\n-    This is equivalent to setting the environment variable\n-    SYMPY_USE_CACHE to 'no'.\n-\n--a, --auto-symbols (requires at least IPython 0.11)\n-\n-    Automatically create missing symbols.  Normally, typing a name of a\n-    Symbol that has not been instantiated first would raise NameError,\n-    but with this option enabled, any undefined name will be\n-    automatically created as a Symbol.\n-\n-    Note that this is intended only for interactive, calculator style\n-    usage. In a script that uses SymPy, Symbols should be instantiated\n-    at the top, so that it's clear what they are.\n-\n-    This will not override any names that are already defined, which\n-    includes the single character letters represented by the mnemonic\n-    QCOSINE (see the \"Gotchas and Pitfalls\" document in the\n-    documentation). You can delete existing names by executing \"del\n-    name\".  If a name is defined, typing \"'name' in dir()\" will return True.\n-\n-    The Symbols that are created using this have default assumptions.\n-    If you want to place assumptions on symbols, you should create them\n-    using symbols() or var().\n-\n-    Finally, this only works in the top level namespace. So, for\n-    example, if you define a function in isympy with an undefined\n-    Symbol, it will not work.\n-\n-    See also the -i and -I options.\n-\n--i, --int-to-Integer (requires at least IPython 0.11)\n-\n-    Automatically wrap int literals with Integer.  This makes it so that\n-    things like 1/2 will come out as Rational(1, 2), rather than 0.5.  This\n-    works by preprocessing the source and wrapping all int literals with\n-    Integer.  Note that this will not change the behavior of int literals\n-    assigned to variables, and it also won't change the behavior of functions\n-    that return int literals.\n-\n-    If you want an int, you can wrap the literal in int(), e.g. int(3)/int(2)\n-    gives 1.5 (with division imported from __future__).\n-\n--I, --interactive (requires at least IPython 0.11)\n-\n-    This is equivalent to --auto-symbols --int-to-Integer.  Future options\n-    designed for ease of interactive use may be added to this.\n-\n--D, --debug\n-\n-    Enable debugging output.  This is the same as setting the\n-    environment variable SYMPY_DEBUG to 'True'.  The debug status is set\n-    in the variable SYMPY_DEBUG within isympy.\n-\n--- IPython options\n-\n-    Additionally you can pass command line options directly to the IPython\n-    interpreter (the standard Python shell is not supported).  However you\n-    need to add the '--' separator between two types of options, e.g the\n-    startup banner option and the colors option. You need to enter the\n-    options as required by the version of IPython that you are using, too:\n-\n-    in IPython 0.11,\n-\n-        $isympy -q -- --colors=NoColor\n-\n-    or older versions of IPython,\n-\n-        $isympy -q -- -colors NoColor\n-\n-See also isympy --help.\n-\"\"\"\n-\n-import os\n-import sys\n-\n-# DO NOT IMPORT SYMPY HERE! Or the setting of the sympy environment variables\n-# by the command line will break.\n-\n-def main():\n-    from argparse import ArgumentParser, RawDescriptionHelpFormatter\n-\n-    VERSION = None\n-    if '--version' in sys.argv:\n-        # We cannot import sympy before this is run, because flags like -C and\n-        # -t set environment variables that must be set before SymPy is\n-        # imported. The only thing we need to import it for is to get the\n-        # version, which only matters with the --version flag.\n-        import sympy\n-        VERSION = sympy.__version__\n-\n-    usage = 'isympy [options] -- [ipython options]'\n-    parser = ArgumentParser(\n-        usage=usage,\n-        description=__doc__,\n-        formatter_class=RawDescriptionHelpFormatter,\n-    )\n-\n-    parser.add_argument('--version', action='version', version=VERSION)\n-\n-    parser.add_argument(\n-        '-c', '--console',\n-        dest='console',\n-        action='store',\n-        default=None,\n-        choices=['ipython', 'python'],\n-        metavar='CONSOLE',\n-        help='select type of interactive session: ipython | python; defaults '\n-        'to ipython if IPython is installed, otherwise python')\n-\n-    parser.add_argument(\n-        '-p', '--pretty',\n-        dest='pretty',\n-        action='store',\n-        default=None,\n-        metavar='PRETTY',\n-        choices=['unicode', 'ascii', 'no'],\n-        help='setup pretty printing: unicode | ascii | no; defaults to '\n-        'unicode printing if the terminal supports it, otherwise ascii')\n-\n-    parser.add_argument(\n-        '-t', '--types',\n-        dest='types',\n-        action='store',\n-        default=None,\n-        metavar='TYPES',\n-        choices=['gmpy', 'gmpy1', 'python'],\n-        help='setup ground types: gmpy | gmpy1 | python; defaults to gmpy if gmpy2 '\n-        'or gmpy is installed, otherwise python')\n-\n-    parser.add_argument(\n-        '-o', '--order',\n-        dest='order',\n-        action='store',\n-        default=None,\n-        metavar='ORDER',\n-        choices=['lex', 'grlex', 'grevlex', 'rev-lex', 'rev-grlex', 'rev-grevlex', 'old', 'none'],\n-        help='setup ordering of terms: [rev-]lex | [rev-]grlex | [rev-]grevlex | old | none; defaults to lex')\n-\n-    parser.add_argument(\n-        '-q', '--quiet',\n-        dest='quiet',\n-        action='store_true',\n-        default=False,\n-        help='print only version information at startup')\n-\n-    parser.add_argument(\n-        '-d', '--doctest',\n-        dest='doctest',\n-        action='store_true',\n-        default=False,\n-        help='use the doctest format for output (you can just copy and paste it)')\n-\n-    parser.add_argument(\n-        '-C', '--no-cache',\n-        dest='cache',\n-        action='store_false',\n-        default=True,\n-        help='disable caching mechanism')\n-\n-    parser.add_argument(\n-        '-a', '--auto-symbols',\n-        dest='auto_symbols',\n-        action='store_true',\n-        default=False,\n-        help='automatically construct missing symbols')\n-\n-    parser.add_argument(\n-        '-i', '--int-to-Integer',\n-        dest='auto_int_to_Integer',\n-        action='store_true',\n-        default=False,\n-        help=\"automatically wrap int literals with Integer\")\n-\n-    parser.add_argument(\n-        '-I', '--interactive',\n-        dest='interactive',\n-        action='store_true',\n-        default=False,\n-        help=\"equivalent to -a -i\")\n-\n-    parser.add_argument(\n-        '-D', '--debug',\n-        dest='debug',\n-        action='store_true',\n-        default=False,\n-        help='enable debugging output')\n-\n-    (options, ipy_args) = parser.parse_known_args()\n-    if '--' in ipy_args:\n-        ipy_args.remove('--')\n-\n-    if not options.cache:\n-        os.environ['SYMPY_USE_CACHE'] = 'no'\n-\n-    if options.types:\n-        os.environ['SYMPY_GROUND_TYPES'] = options.types\n-\n-    if options.debug:\n-        os.environ['SYMPY_DEBUG'] = str(options.debug)\n-\n-    if options.doctest:\n-        options.pretty = 'no'\n-        options.console = 'python'\n-\n-    session = options.console\n-\n-    if session is not None:\n-        ipython = session == 'ipython'\n-    else:\n-        try:\n-            import IPython\n-            ipython = True\n-        except ImportError:\n-            if not options.quiet:\n-                from sympy.interactive.session import no_ipython\n-                print(no_ipython)\n-            ipython = False\n-\n-    args = {\n-        'pretty_print': True,\n-        'use_unicode':  None,\n-        'use_latex':    None,\n-        'order':        None,\n-        'argv':         ipy_args,\n-    }\n-\n-    if options.pretty == 'unicode':\n-        args['use_unicode'] = True\n-    elif options.pretty == 'ascii':\n-        args['use_unicode'] = False\n-    elif options.pretty == 'no':\n-        args['pretty_print'] = False\n-\n-    if options.order is not None:\n-        args['order'] = options.order\n-\n-    args['quiet'] = options.quiet\n-    args['auto_symbols'] = options.auto_symbols or options.interactive\n-    args['auto_int_to_Integer'] = options.auto_int_to_Integer or options.interactive\n-\n-    from sympy.interactive import init_session\n-    init_session(ipython, **args)\n-\n-if __name__ == \"__main__\":\n-    main()\ndiff --git a/setup.py b/setup.py\ndeleted file mode 100755\nindex 615052e878..0000000000\n--- a/setup.py\n+++ /dev/null\n@@ -1,477 +0,0 @@\n-#!/usr/bin/env python\n-\"\"\"Distutils based setup script for SymPy.\n-\n-This uses Distutils (https://python.org/sigs/distutils-sig/) the standard\n-python mechanism for installing packages. Optionally, you can use\n-Setuptools (https://setuptools.readthedocs.io/en/latest/)\n-to automatically handle dependencies. For the easiest installation\n-just type the command (you'll probably need root privileges for that):\n-\n-    python setup.py install\n-\n-This will install the library in the default location. For instructions on\n-how to customize the install procedure read the output of:\n-\n-    python setup.py --help install\n-\n-In addition, there are some other commands:\n-\n-    python setup.py clean -> will clean all trash (*.pyc and stuff)\n-    python setup.py test  -> will run the complete test suite\n-    python setup.py bench -> will run the complete benchmark suite\n-    python setup.py audit -> will run pyflakes checker on source code\n-\n-To get a full list of available commands, read the output of:\n-\n-    python setup.py --help-commands\n-\n-Or, if all else fails, feel free to write to the sympy list at\n-sympy@googlegroups.com and ask for help.\n-\"\"\"\n-\n-import sys\n-import os\n-import shutil\n-import glob\n-import subprocess\n-\n-from distutils.command.sdist import sdist\n-\n-\n-min_mpmath_version = '0.19'\n-\n-# This directory\n-dir_setup = os.path.dirname(os.path.realpath(__file__))\n-\n-extra_kwargs = {}\n-\n-try:\n-    from setuptools import setup, Command\n-    extra_kwargs['zip_safe'] = False\n-    extra_kwargs['entry_points'] = {\n-        'console_scripts': [\n-            'isympy = isympy:main',\n-        ]\n-    }\n-except ImportError:\n-    from distutils.core import setup, Command\n-\n-    extra_kwargs['scripts'] = ['bin/isympy']\n-\n-    # handle mpmath deps in the hard way:\n-    from distutils.version import LooseVersion\n-    try:\n-        import mpmath\n-        if mpmath.__version__ < LooseVersion(min_mpmath_version):\n-            raise ImportError\n-    except ImportError:\n-        print(\"Please install the mpmath package with a version >= %s\"\n-              % min_mpmath_version)\n-        sys.exit(-1)\n-\n-if sys.version_info < (3, 6):\n-    print(\"SymPy requires Python 3.6 or newer. Python %d.%d detected\"\n-          % sys.version_info[:2])\n-    sys.exit(-1)\n-\n-# Check that this list is uptodate against the result of the command:\n-# python bin/generate_module_list.py\n-modules = [\n-    'sympy.algebras',\n-    'sympy.assumptions',\n-    'sympy.assumptions.handlers',\n-    'sympy.assumptions.predicates',\n-    'sympy.assumptions.relation',\n-    'sympy.benchmarks',\n-    'sympy.calculus',\n-    'sympy.categories',\n-    'sympy.codegen',\n-    'sympy.combinatorics',\n-    'sympy.concrete',\n-    'sympy.core',\n-    'sympy.core.benchmarks',\n-    'sympy.crypto',\n-    'sympy.diffgeom',\n-    'sympy.discrete',\n-    'sympy.external',\n-    'sympy.functions',\n-    'sympy.functions.combinatorial',\n-    'sympy.functions.elementary',\n-    'sympy.functions.elementary.benchmarks',\n-    'sympy.functions.special',\n-    'sympy.functions.special.benchmarks',\n-    'sympy.geometry',\n-    'sympy.holonomic',\n-    'sympy.integrals',\n-    'sympy.integrals.benchmarks',\n-    'sympy.integrals.rubi',\n-    'sympy.integrals.rubi.parsetools',\n-    'sympy.integrals.rubi.rubi_tests',\n-    'sympy.integrals.rubi.rules',\n-    'sympy.interactive',\n-    'sympy.liealgebras',\n-    'sympy.logic',\n-    'sympy.logic.algorithms',\n-    'sympy.logic.utilities',\n-    'sympy.matrices',\n-    'sympy.matrices.benchmarks',\n-    'sympy.matrices.expressions',\n-    'sympy.multipledispatch',\n-    'sympy.ntheory',\n-    'sympy.parsing',\n-    'sympy.parsing.autolev',\n-    'sympy.parsing.autolev._antlr',\n-    'sympy.parsing.c',\n-    'sympy.parsing.fortran',\n-    'sympy.parsing.latex',\n-    'sympy.parsing.latex._antlr',\n-    'sympy.physics',\n-    'sympy.physics.continuum_mechanics',\n-    'sympy.physics.control',\n-    'sympy.physics.hep',\n-    'sympy.physics.mechanics',\n-    'sympy.physics.optics',\n-    'sympy.physics.quantum',\n-    'sympy.physics.units',\n-    'sympy.physics.units.definitions',\n-    'sympy.physics.units.systems',\n-    'sympy.physics.vector',\n-    'sympy.plotting',\n-    'sympy.plotting.intervalmath',\n-    'sympy.plotting.pygletplot',\n-    'sympy.polys',\n-    'sympy.polys.agca',\n-    'sympy.polys.benchmarks',\n-    'sympy.polys.domains',\n-    'sympy.polys.matrices',\n-    'sympy.printing',\n-    'sympy.printing.pretty',\n-    'sympy.sandbox',\n-    'sympy.series',\n-    'sympy.series.benchmarks',\n-    'sympy.sets',\n-    'sympy.sets.handlers',\n-    'sympy.simplify',\n-    'sympy.solvers',\n-    'sympy.solvers.benchmarks',\n-    'sympy.solvers.diophantine',\n-    'sympy.solvers.ode',\n-    'sympy.stats',\n-    'sympy.stats.sampling',\n-    'sympy.strategies',\n-    'sympy.strategies.branch',\n-    'sympy.tensor',\n-    'sympy.tensor.array',\n-    'sympy.tensor.array.expressions',\n-    'sympy.testing',\n-    'sympy.unify',\n-    'sympy.utilities',\n-    'sympy.utilities._compilation',\n-    'sympy.utilities.mathml',\n-    'sympy.vector',\n-]\n-\n-class audit(Command):\n-    \"\"\"Audits SymPy's source code for following issues:\n-        - Names which are used but not defined or used before they are defined.\n-        - Names which are redefined without having been used.\n-    \"\"\"\n-\n-    description = \"Audit SymPy source with PyFlakes\"\n-    user_options = []\n-\n-    def initialize_options(self):\n-        self.all = None\n-\n-    def finalize_options(self):\n-        pass\n-\n-    def run(self):\n-        import os\n-        try:\n-            import pyflakes.scripts.pyflakes as flakes\n-        except ImportError:\n-            print(\"In order to run the audit, you need to have PyFlakes installed.\")\n-            sys.exit(-1)\n-        dirs = (os.path.join(*d) for d in (m.split('.') for m in modules))\n-        warns = 0\n-        for dir in dirs:\n-            for filename in os.listdir(dir):\n-                if filename.endswith('.py') and filename != '__init__.py':\n-                    warns += flakes.checkPath(os.path.join(dir, filename))\n-        if warns > 0:\n-            print(\"Audit finished with total %d warnings\" % warns)\n-\n-\n-class clean(Command):\n-    \"\"\"Cleans *.pyc and debian trashs, so you should get the same copy as\n-    is in the VCS.\n-    \"\"\"\n-\n-    description = \"remove build files\"\n-    user_options = [(\"all\", \"a\", \"the same\")]\n-\n-    def initialize_options(self):\n-        self.all = None\n-\n-    def finalize_options(self):\n-        pass\n-\n-    def run(self):\n-        curr_dir = os.getcwd()\n-        for root, dirs, files in os.walk(dir_setup):\n-            for file in files:\n-                if file.endswith('.pyc') and os.path.isfile:\n-                    os.remove(os.path.join(root, file))\n-\n-        os.chdir(dir_setup)\n-        names = [\"python-build-stamp-2.4\", \"MANIFEST\", \"build\",\n-                 \"dist\", \"doc/_build\", \"sample.tex\"]\n-\n-        for f in names:\n-            if os.path.isfile(f):\n-                os.remove(f)\n-            elif os.path.isdir(f):\n-                shutil.rmtree(f)\n-\n-        for name in glob.glob(os.path.join(dir_setup, \"doc\", \"src\", \"modules\",\n-                                           \"physics\", \"vector\", \"*.pdf\")):\n-            if os.path.isfile(name):\n-                os.remove(name)\n-\n-        os.chdir(curr_dir)\n-\n-\n-class test_sympy(Command):\n-    \"\"\"Runs all tests under the sympy/ folder\n-    \"\"\"\n-\n-    description = \"run all tests and doctests; also see bin/test and bin/doctest\"\n-    user_options = []  # distutils complains if this is not here.\n-\n-    def __init__(self, *args):\n-        self.args = args[0]  # so we can pass it to other classes\n-        Command.__init__(self, *args)\n-\n-    def initialize_options(self):  # distutils wants this\n-        pass\n-\n-    def finalize_options(self):    # this too\n-        pass\n-\n-    def run(self):\n-        from sympy.utilities import runtests\n-        runtests.run_all_tests()\n-\n-\n-class run_benchmarks(Command):\n-    \"\"\"Runs all SymPy benchmarks\"\"\"\n-\n-    description = \"run all benchmarks\"\n-    user_options = []  # distutils complains if this is not here.\n-\n-    def __init__(self, *args):\n-        self.args = args[0]  # so we can pass it to other classes\n-        Command.__init__(self, *args)\n-\n-    def initialize_options(self):  # distutils wants this\n-        pass\n-\n-    def finalize_options(self):    # this too\n-        pass\n-\n-    # we use py.test like architecture:\n-    #\n-    # o collector   -- collects benchmarks\n-    # o runner      -- executes benchmarks\n-    # o presenter   -- displays benchmarks results\n-    #\n-    # this is done in sympy.utilities.benchmarking on top of py.test\n-    def run(self):\n-        from sympy.utilities import benchmarking\n-        benchmarking.main(['sympy'])\n-\n-\n-class antlr(Command):\n-    \"\"\"Generate code with antlr4\"\"\"\n-    description = \"generate parser code from antlr grammars\"\n-    user_options = []  # distutils complains if this is not here.\n-\n-    def __init__(self, *args):\n-        self.args = args[0]  # so we can pass it to other classes\n-        Command.__init__(self, *args)\n-\n-    def initialize_options(self):  # distutils wants this\n-        pass\n-\n-    def finalize_options(self):    # this too\n-        pass\n-\n-    def run(self):\n-        from sympy.parsing.latex._build_latex_antlr import build_parser\n-        if not build_parser():\n-            sys.exit(-1)\n-\n-\n-class sdist_sympy(sdist):\n-    def run(self):\n-        # Fetch git commit hash and write down to commit_hash.txt before\n-        # shipped in tarball.\n-        commit_hash = None\n-        commit_hash_filepath = 'doc/commit_hash.txt'\n-        try:\n-            commit_hash = \\\n-                subprocess.check_output(['git', 'rev-parse', 'HEAD'])\n-            commit_hash = commit_hash.decode('ascii')\n-            commit_hash = commit_hash.rstrip()\n-            print('Commit hash found : {}.'.format(commit_hash))\n-            print('Writing it to {}.'.format(commit_hash_filepath))\n-        except:\n-            pass\n-\n-        if commit_hash:\n-            with open(commit_hash_filepath, 'w') as f:\n-                f.write(commit_hash)\n-\n-        super(sdist_sympy, self).run()\n-\n-        try:\n-            os.remove(commit_hash_filepath)\n-            print(\n-                'Successfully removed temporary file {}.'\n-                .format(commit_hash_filepath))\n-        except OSError as e:\n-            print(\"Error deleting %s - %s.\" % (e.filename, e.strerror))\n-\n-\n-# Check that this list is uptodate against the result of the command:\n-# python bin/generate_test_list.py\n-tests = [\n-    'sympy.algebras.tests',\n-    'sympy.assumptions.tests',\n-    'sympy.calculus.tests',\n-    'sympy.categories.tests',\n-    'sympy.codegen.tests',\n-    'sympy.combinatorics.tests',\n-    'sympy.concrete.tests',\n-    'sympy.core.tests',\n-    'sympy.crypto.tests',\n-    'sympy.diffgeom.tests',\n-    'sympy.discrete.tests',\n-    'sympy.external.tests',\n-    'sympy.functions.combinatorial.tests',\n-    'sympy.functions.elementary.tests',\n-    'sympy.functions.special.tests',\n-    'sympy.geometry.tests',\n-    'sympy.holonomic.tests',\n-    'sympy.integrals.rubi.parsetools.tests',\n-    'sympy.integrals.rubi.rubi_tests.tests',\n-    'sympy.integrals.rubi.tests',\n-    'sympy.integrals.tests',\n-    'sympy.interactive.tests',\n-    'sympy.liealgebras.tests',\n-    'sympy.logic.tests',\n-    'sympy.matrices.expressions.tests',\n-    'sympy.matrices.tests',\n-    'sympy.multipledispatch.tests',\n-    'sympy.ntheory.tests',\n-    'sympy.parsing.tests',\n-    'sympy.physics.continuum_mechanics.tests',\n-    'sympy.physics.control.tests',\n-    'sympy.physics.hep.tests',\n-    'sympy.physics.mechanics.tests',\n-    'sympy.physics.optics.tests',\n-    'sympy.physics.quantum.tests',\n-    'sympy.physics.tests',\n-    'sympy.physics.units.tests',\n-    'sympy.physics.vector.tests',\n-    'sympy.plotting.intervalmath.tests',\n-    'sympy.plotting.pygletplot.tests',\n-    'sympy.plotting.tests',\n-    'sympy.polys.agca.tests',\n-    'sympy.polys.domains.tests',\n-    'sympy.polys.matrices.tests',\n-    'sympy.polys.tests',\n-    'sympy.printing.pretty.tests',\n-    'sympy.printing.tests',\n-    'sympy.sandbox.tests',\n-    'sympy.series.tests',\n-    'sympy.sets.tests',\n-    'sympy.simplify.tests',\n-    'sympy.solvers.diophantine.tests',\n-    'sympy.solvers.ode.tests',\n-    'sympy.solvers.tests',\n-    'sympy.stats.sampling.tests',\n-    'sympy.stats.tests',\n-    'sympy.strategies.branch.tests',\n-    'sympy.strategies.tests',\n-    'sympy.tensor.array.expressions.tests',\n-    'sympy.tensor.array.tests',\n-    'sympy.tensor.tests',\n-    'sympy.testing.tests',\n-    'sympy.unify.tests',\n-    'sympy.utilities._compilation.tests',\n-    'sympy.utilities.tests',\n-    'sympy.vector.tests',\n-]\n-\n-\n-with open(os.path.join(dir_setup, 'sympy', 'release.py')) as f:\n-    # Defines __version__\n-    exec(f.read())\n-\n-\n-if __name__ == '__main__':\n-    setup(name='sympy',\n-          version=__version__,\n-          description='Computer algebra system (CAS) in Python',\n-          author='SymPy development team',\n-          author_email='sympy@googlegroups.com',\n-          license='BSD',\n-          keywords=\"Math CAS\",\n-          url='https://sympy.org',\n-          py_modules=['isympy'],\n-          packages=['sympy'] + modules + tests,\n-          ext_modules=[],\n-          package_data={\n-              'sympy.utilities.mathml': ['data/*.xsl'],\n-              'sympy.logic.benchmarks': ['input/*.cnf'],\n-              'sympy.parsing.autolev': [\n-                  '*.g4', 'test-examples/*.al', 'test-examples/*.py',\n-                  'test-examples/pydy-example-repo/*.al',\n-                  'test-examples/pydy-example-repo/*.py',\n-                  'test-examples/README.txt',\n-                  ],\n-              'sympy.parsing.latex': ['*.txt', '*.g4'],\n-              'sympy.integrals.rubi.parsetools': ['header.py.txt'],\n-              'sympy.plotting.tests': ['test_region_*.png'],\n-              },\n-          data_files=[('share/man/man1', ['doc/man/isympy.1'])],\n-          cmdclass={'test': test_sympy,\n-                    'bench': run_benchmarks,\n-                    'clean': clean,\n-                    'audit': audit,\n-                    'antlr': antlr,\n-                    'sdist': sdist_sympy,\n-                    },\n-          python_requires='>=3.6',\n-          classifiers=[\n-            'License :: OSI Approved :: BSD License',\n-            'Operating System :: OS Independent',\n-            'Programming Language :: Python',\n-            'Topic :: Scientific/Engineering',\n-            'Topic :: Scientific/Engineering :: Mathematics',\n-            'Topic :: Scientific/Engineering :: Physics',\n-            'Programming Language :: Python :: 3',\n-            'Programming Language :: Python :: 3.6',\n-            'Programming Language :: Python :: 3.7',\n-            'Programming Language :: Python :: 3.8',\n-            'Programming Language :: Python :: 3 :: Only',\n-            'Programming Language :: Python :: Implementation :: CPython',\n-            'Programming Language :: Python :: Implementation :: PyPy',\n-            ],\n-          install_requires=[\n-            'mpmath>=%s' % min_mpmath_version,\n-            ],\n-          **extra_kwargs\n-          )\ndiff --git a/setupegg.py b/setupegg.py\ndeleted file mode 100644\nindex 3f51932564..0000000000\n--- a/setupegg.py\n+++ /dev/null\n@@ -1,3 +0,0 @@\n-import setuptools\n-\n-exec(open('setup.py').read())\ndiff --git a/sympy/parsing/latex/_parse_latex_antlr.py b/sympy/parsing/latex/_parse_latex_antlr.py\nindex 2e4a45ad20..ad87e2a4d6 100644\n--- a/sympy/parsing/latex/_parse_latex_antlr.py\n+++ b/sympy/parsing/latex/_parse_latex_antlr.py\n@@ -382,9 +382,25 @@ def convert_frac(frac):\n \n     expr_top = convert_expr(frac.upper)\n     expr_bot = convert_expr(frac.lower)\n+    \n+    # Handle nested fractions properly by wrapping complex denominators\n+    # When the denominator is a Pow with negative exponent (like 1/x^2), \n+    # we need to wrap it to ensure proper parentheses in nested fractions\n+    if isinstance(expr_bot, sympy.Pow) and expr_bot.exp.is_negative:\n+        # Wrap the denominator in a Mul to force proper parentheses\n+        expr_bot = sympy.Mul(1, expr_bot, evaluate=False)\n+    \n     inverse_denom = sympy.Pow(expr_bot, -1, evaluate=False)\n+    \n     if expr_top == 1:\n-        return inverse_denom\n+        # For simple fractions like \\frac{1}{x}, return just the inverse\n+        # But for nested fractions, we need Mul to get proper parentheses\n+        if isinstance(expr_bot, sympy.Mul):\n+            # expr_bot is a fraction (Mul object), so we need Mul for proper parentheses\n+            return sympy.Mul(expr_top, inverse_denom, evaluate=False)\n+        else:\n+            # expr_bot is a simple expression, return just the inverse\n+            return inverse_denom\n     else:\n         return sympy.Mul(expr_top, inverse_denom, evaluate=False)\n \n"}