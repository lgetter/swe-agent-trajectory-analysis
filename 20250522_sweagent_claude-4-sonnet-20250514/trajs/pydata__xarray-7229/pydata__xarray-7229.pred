{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "pydata__xarray-7229", "model_patch": "diff --git a/xarray/core/computation.py b/xarray/core/computation.py\nindex 3f7e8f74..2defb027 100644\n--- a/xarray/core/computation.py\n+++ b/xarray/core/computation.py\n@@ -1857,22 +1857,44 @@ def where(cond, x, y, keep_attrs=None):\n     \"\"\"\n     if keep_attrs is None:\n         keep_attrs = _get_keep_attrs(default=False)\n+    \n+    # Handle keep_attrs=True specially to preserve coordinate attributes\n+    # while keeping main variable attributes from x\n     if keep_attrs is True:\n-        # keep the attributes of x, the second parameter, by default to\n-        # be consistent with the `where` method of `DataArray` and `Dataset`\n-        keep_attrs = lambda attrs, context: getattr(x, \"attrs\", {})\n-\n-    # alignment for three arguments is complicated, so don't support it yet\n-    return apply_ufunc(\n-        duck_array_ops.where,\n-        cond,\n-        x,\n-        y,\n-        join=\"exact\",\n-        dataset_join=\"exact\",\n-        dask=\"allowed\",\n-        keep_attrs=keep_attrs,\n-    )\n+        # Use \"override\" for coordinate merging to preserve coordinate attributes\n+        result = apply_ufunc(\n+            duck_array_ops.where,\n+            cond,\n+            x,\n+            y,\n+            join=\"exact\",\n+            dataset_join=\"exact\",\n+            dask=\"allowed\",\n+            keep_attrs=\"override\",\n+        )\n+        \n+        # For the main variable attributes, explicitly use x's attributes\n+        # to be consistent with the `where` method of `DataArray` and `Dataset`\n+        if hasattr(result, \"attrs\"):\n+            if hasattr(x, \"attrs\"):\n+                result.attrs = x.attrs\n+            else:\n+                # If x doesn't have attrs (e.g., it's a scalar), use empty attrs\n+                result.attrs = {}\n+        \n+        return result\n+    else:\n+        # For other keep_attrs values, use the normal behavior\n+        return apply_ufunc(\n+            duck_array_ops.where,\n+            cond,\n+            x,\n+            y,\n+            join=\"exact\",\n+            dataset_join=\"exact\",\n+            dask=\"allowed\",\n+            keep_attrs=keep_attrs,\n+        )\n \n \n @overload\n"}