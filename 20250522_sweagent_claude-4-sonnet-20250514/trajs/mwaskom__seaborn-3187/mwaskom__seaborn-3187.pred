{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "mwaskom__seaborn-3187", "model_patch": "diff --git a/seaborn/_core/scales.py b/seaborn/_core/scales.py\nindex 55874bf2..f80305b4 100644\n--- a/seaborn/_core/scales.py\n+++ b/seaborn/_core/scales.py\n@@ -379,6 +379,35 @@ class ContinuousBase(Scale):\n             locs = axis.major.locator()\n             locs = locs[(vmin <= locs) & (locs <= vmax)]\n             labels = axis.major.formatter.format_ticks(locs)\n+            \n+            # Handle ScalarFormatter offset for large numbers\n+            formatter = axis.major.formatter\n+            if hasattr(formatter, 'get_offset') and formatter.get_offset():\n+                offset = formatter.get_offset()\n+                try:\n+                    # Parse the offset (could be in scientific notation like '1e6')\n+                    offset_value = float(offset)\n+                    # Reconstruct the full values by multiplying labels by offset\n+                    corrected_labels = []\n+                    for label in labels:\n+                        try:\n+                            # Handle unicode minus sign (U+2212) used by matplotlib\n+                            label_clean = label.replace('\u2212', '-')\n+                            # Convert label to float and multiply by offset\n+                            full_value = float(label_clean) * offset_value\n+                            # Format the full value appropriately\n+                            if full_value == int(full_value):\n+                                corrected_labels.append(str(int(full_value)))\n+                            else:\n+                                corrected_labels.append(str(full_value))\n+                        except (ValueError, TypeError):\n+                            # If we can't parse the label, keep it as is\n+                            corrected_labels.append(label)\n+                    labels = corrected_labels\n+                except (ValueError, TypeError):\n+                    # If we can't parse the offset, keep original labels\n+                    pass\n+            \n             new._legend = list(locs), list(labels)\n \n         return new\ndiff --git a/seaborn/utils.py b/seaborn/utils.py\nindex 2407853c..914ad9ba 100644\n--- a/seaborn/utils.py\n+++ b/seaborn/utils.py\n@@ -705,7 +705,34 @@ def locator_to_legend_entries(locator, limits, dtype):\n     # once pinned matplotlib>=3.1.0 with:\n     # formatted_levels = formatter.format_ticks(raw_levels)\n     formatter.set_locs(raw_levels)\n-    formatted_levels = [formatter(x) for x in raw_levels]\n+    formatted_levels = formatter.format_ticks(raw_levels)\n+    \n+    # Handle ScalarFormatter offset for large numbers\n+    if hasattr(formatter, 'get_offset') and formatter.get_offset():\n+        offset = formatter.get_offset()\n+        try:\n+            # Parse the offset (could be in scientific notation like '1e6')\n+            offset_value = float(offset)\n+            # Reconstruct the full values by multiplying labels by offset\n+            corrected_labels = []\n+            for label in formatted_levels:\n+                try:\n+                    # Handle unicode minus sign (U+2212) used by matplotlib\n+                    label_clean = label.replace('\u2212', '-')\n+                    # Convert label to float and multiply by offset\n+                    full_value = float(label_clean) * offset_value\n+                    # Format the full value appropriately\n+                    if full_value == int(full_value):\n+                        corrected_labels.append(str(int(full_value)))\n+                    else:\n+                        corrected_labels.append(str(full_value))\n+                except (ValueError, TypeError):\n+                    # If we can't parse the label, keep it as is\n+                    corrected_labels.append(label)\n+            formatted_levels = corrected_labels\n+        except (ValueError, TypeError):\n+            # If we can't parse the offset, keep original labels\n+            pass\n \n     return raw_levels, formatted_levels\n \n"}