{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "sphinx-doc__sphinx-10673", "model_patch": "diff --git a/sphinx/directives/other.py b/sphinx/directives/other.py\nindex 35e16e623..c8c045039 100644\n--- a/sphinx/directives/other.py\n+++ b/sphinx/directives/other.py\n@@ -76,6 +76,33 @@ class TocTree(SphinxDirective):\n         ret.append(wrappernode)\n         return ret\n \n+    def _is_builtin_toctree_entry(self, docname: str) -> bool:\n+        \"\"\"Check if docname refers to a built-in special page like genindex, modindex, search.\"\"\"\n+        # Check standard domain labels for built-in pages\n+        try:\n+            std_domain = self.env.get_domain('std')\n+            if hasattr(std_domain, 'data') and 'labels' in std_domain.data:\n+                # Check if this docname is a label name (like 'modindex' -> 'py-modindex')\n+                if docname in std_domain.data['labels']:\n+                    return True\n+                # Also check if this docname is a target for any of the standard labels\n+                for label_name, (target_docname, labelid, sectionname) in std_domain.data['labels'].items():\n+                    if target_docname == docname:\n+                        return True\n+            \n+            # Also check domain indices (like py-modindex)\n+            for domain in self.env.domains.values():\n+                for index_cls in domain.indices:\n+                    if hasattr(index_cls, 'name') and index_cls.name:\n+                        index_docname = f\"{domain.name}-{index_cls.name}\"\n+                        if index_docname == docname:\n+                            return True\n+        except Exception:\n+            # If anything goes wrong, don't treat it as a built-in page\n+            pass\n+        \n+        return False\n+\n     def parse_content(self, toctree: addnodes.toctree) -> List[Node]:\n         suffixes = self.config.source_suffix\n \n@@ -119,16 +146,22 @@ class TocTree(SphinxDirective):\n                 if url_re.match(ref) or ref == 'self':\n                     toctree['entries'].append((title, ref))\n                 elif docname not in self.env.found_docs:\n-                    if excluded(self.env.doc2path(docname, False)):\n+                    # Check if this is a built-in special page (genindex, modindex, search, etc.)\n+                    if self._is_builtin_toctree_entry(docname):\n+                        # Built-in pages are valid toctree entries, add them without warning\n+                        toctree['entries'].append((title, docname))\n+                    elif excluded(self.env.doc2path(docname, False)):\n                         message = __('toctree contains reference to excluded document %r')\n                         subtype = 'excluded'\n+                        logger.warning(message, docname, type='toc', subtype=subtype,\n+                                       location=toctree)\n+                        self.env.note_reread()\n                     else:\n                         message = __('toctree contains reference to nonexisting document %r')\n                         subtype = 'not_readable'\n-\n-                    logger.warning(message, docname, type='toc', subtype=subtype,\n-                                   location=toctree)\n-                    self.env.note_reread()\n+                        logger.warning(message, docname, type='toc', subtype=subtype,\n+                                       location=toctree)\n+                        self.env.note_reread()\n                 else:\n                     if docname in all_docnames:\n                         all_docnames.remove(docname)\ndiff --git a/sphinx/environment/adapters/toctree.py b/sphinx/environment/adapters/toctree.py\nindex 9678e3c7c..d0c32961e 100644\n--- a/sphinx/environment/adapters/toctree.py\n+++ b/sphinx/environment/adapters/toctree.py\n@@ -23,6 +23,33 @@ class TocTree:\n     def __init__(self, env: \"BuildEnvironment\") -> None:\n         self.env = env\n \n+    def _is_builtin_toctree_entry(self, docname: str) -> bool:\n+        \"\"\"Check if docname refers to a built-in special page like genindex, modindex, search.\"\"\"\n+        # Check standard domain labels for built-in pages\n+        try:\n+            std_domain = self.env.get_domain('std')\n+            if hasattr(std_domain, 'data') and 'labels' in std_domain.data:\n+                # Check if this docname is a label name (like 'modindex' -> 'py-modindex')\n+                if docname in std_domain.data['labels']:\n+                    return True\n+                # Also check if this docname is a target for any of the standard labels\n+                for label_name, (target_docname, labelid, sectionname) in std_domain.data['labels'].items():\n+                    if target_docname == docname:\n+                        return True\n+            \n+            # Also check domain indices (like py-modindex)\n+            for domain in self.env.domains.values():\n+                for index_cls in domain.indices:\n+                    if hasattr(index_cls, 'name') and index_cls.name:\n+                        index_docname = f\"{domain.name}-{index_cls.name}\"\n+                        if index_docname == docname:\n+                            return True\n+        except Exception:\n+            # If anything goes wrong, don't treat it as a built-in page\n+            pass\n+        \n+        return False\n+\n     def note(self, docname: str, toctreenode: addnodes.toctree) -> None:\n         \"\"\"Note a TOC tree directive in a document and gather information about\n         file relations from it.\n@@ -165,15 +192,45 @@ class TocTree:\n                                        ref, location=toctreenode)\n                 except KeyError:\n                     # this is raised if the included file does not exist\n-                    if excluded(self.env.doc2path(ref, False)):\n+                    # Check if this is a built-in special page (genindex, modindex, search, etc.)\n+                    if self._is_builtin_toctree_entry(ref):\n+                        # Built-in pages don't have tocs but should be treated as valid references\n+                        # Create a simple reference node for them\n+                        if title is None:\n+                            # Use a default title based on the page type\n+                            if ref == 'genindex':\n+                                title = 'Index'\n+                            elif ref == 'search':\n+                                title = 'Search Page'\n+                            elif ref.endswith('-modindex'):\n+                                title = 'Module Index'\n+                            elif ref == 'modindex':\n+                                # Handle the common case where users write 'modindex' instead of 'py-modindex'\n+                                title = 'Module Index'\n+                            else:\n+                                title = ref.title()\n+                        \n+                        reference = nodes.reference('', '', internal=True,\n+                                                   refuri=ref, anchorname='',\n+                                                   *[nodes.Text(title)])\n+                        para = addnodes.compact_paragraph('', '', reference)\n+                        item = nodes.list_item('', para)\n+                        toc = nodes.bullet_list('', item)\n+                    elif excluded(self.env.doc2path(ref, False)):\n                         message = __('toctree contains reference to excluded document %r')\n+                        logger.warning(message, ref, location=toctreenode)\n+                        continue\n                     elif not included(self.env.doc2path(ref, False)):\n                         message = __('toctree contains reference to non-included document %r')\n+                        logger.warning(message, ref, location=toctreenode)\n+                        continue\n                     else:\n                         message = __('toctree contains reference to nonexisting document %r')\n-\n-                    logger.warning(message, ref, location=toctreenode)\n-                else:\n+                        logger.warning(message, ref, location=toctreenode)\n+                        continue\n+                \n+                # Process the toc (either from normal document or built-in page)\n+                if 'toc' in locals():\n                     # if titles_only is given, only keep the main title and\n                     # sub-toctrees\n                     if titles_only:\ndiff --git a/tox.ini b/tox.ini\nindex 7ca990b56..a0708b02c 100644\n--- a/tox.ini\n+++ b/tox.ini\n@@ -30,7 +30,7 @@ setenv =\n     PYTHONWARNINGS = all\n     PYTEST_ADDOPTS = {env:PYTEST_ADDOPTS:} --color yes\n commands=\n-    python -X dev -X warn_default_encoding -m pytest --durations 25 {posargs}\n+    python -X dev -X warn_default_encoding -m pytest -rA --durations 25 {posargs}\n \n [testenv:du-latest]\n commands =\n"}