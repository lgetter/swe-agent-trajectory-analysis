{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "scikit-learn__scikit-learn-26194", "model_patch": "diff --git a/sklearn/metrics/_ranking.py b/sklearn/metrics/_ranking.py\nindex 0cdead923..a8e020979 100644\n--- a/sklearn/metrics/_ranking.py\n+++ b/sklearn/metrics/_ranking.py\n@@ -1083,7 +1083,20 @@ def roc_curve(\n     # to make sure that the curve starts at (0, 0)\n     tps = np.r_[0, tps]\n     fps = np.r_[0, fps]\n-    thresholds = np.r_[thresholds[0] + 1, thresholds]\n+    \n+    # Calculate the first threshold using the original logic\n+    first_threshold = thresholds[0] + 1\n+    \n+    # For probability estimates (scores in [0, 1]), ensure the first threshold doesn't \n+    # exceed 1 when the max score is < 1. This prevents thresholds > 1 for probability\n+    # estimates while preserving backward compatibility when max score is exactly 1.0.\n+    y_score_array = np.asarray(y_score)\n+    if (np.all(y_score_array >= 0) and np.all(y_score_array <= 1) and \n+        thresholds[0] < 1.0 and first_threshold > 1.0):\n+        # Use a threshold slightly above 1 to ensure no instances are predicted\n+        first_threshold = 1.0 + np.finfo(np.float64).eps\n+    \n+    thresholds = np.r_[first_threshold, thresholds]\n \n     if fps[-1] <= 0:\n         warnings.warn(\n"}