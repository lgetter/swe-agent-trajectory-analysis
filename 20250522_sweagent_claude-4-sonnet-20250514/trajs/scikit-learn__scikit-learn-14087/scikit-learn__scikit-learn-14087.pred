{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "scikit-learn__scikit-learn-14087", "model_patch": "diff --git a/sklearn/linear_model/logistic.py b/sklearn/linear_model/logistic.py\nindex 1999f1dae..bbcf29306 100644\n--- a/sklearn/linear_model/logistic.py\n+++ b/sklearn/linear_model/logistic.py\n@@ -2170,7 +2170,7 @@ class LogisticRegressionCV(LogisticRegression, BaseEstimator,\n                 # Take the best scores across every fold and the average of\n                 # all coefficients corresponding to the best scores.\n                 best_indices = np.argmax(scores, axis=1)\n-                if self.multi_class == 'ovr':\n+                if multi_class == 'ovr':\n                     w = np.mean([coefs_paths[i, best_indices[i], :]\n                                  for i in range(len(folds))], axis=0)\n                 else:\n@@ -2181,7 +2181,10 @@ class LogisticRegressionCV(LogisticRegression, BaseEstimator,\n                 self.C_.append(np.mean(self.Cs_[best_indices_C]))\n \n                 best_indices_l1 = best_indices // len(self.Cs_)\n-                self.l1_ratio_.append(np.mean(l1_ratios_[best_indices_l1]))\n+                if l1_ratios_[0] is None:\n+                    self.l1_ratio_.append(None)\n+                else:\n+                    self.l1_ratio_.append(np.mean([l1_ratios_[i] for i in best_indices_l1]))\n \n             if multi_class == 'multinomial':\n                 self.C_ = np.tile(self.C_, n_classes)\ndiff --git a/sklearn/linear_model/tests/test_logistic.py b/sklearn/linear_model/tests/test_logistic.py\nindex 6ad9a4ec9..fc85930d6 100644\n--- a/sklearn/linear_model/tests/test_logistic.py\n+++ b/sklearn/linear_model/tests/test_logistic.py\n@@ -1554,6 +1554,35 @@ def test_LogisticRegressionCV_no_refit(multi_class):\n     assert lrcv.coef_.shape == (n_classes, n_features)\n \n \n+def test_LogisticRegressionCV_no_refit_binary_classification():\n+    # Test LogisticRegressionCV with refit=False on binary classification\n+    # This is a regression test for issue where IndexError was thrown\n+    # when using refit=False with binary classification and non-elasticnet penalty\n+    \n+    np.random.seed(29)\n+    X = np.random.normal(size=(100, 3))\n+    beta = np.random.normal(size=3)\n+    intercept = np.random.normal(size=None)\n+    y = np.sign(intercept + X @ beta)\n+    \n+    # Test with different solvers that were mentioned in the issue\n+    for solver in ['saga', 'liblinear']:\n+        lrcv = LogisticRegressionCV(\n+            cv=5,\n+            solver=solver,\n+            tol=1e-2,\n+            refit=False\n+        )\n+        # This should not raise an IndexError\n+        lrcv.fit(X, y)\n+        \n+        # Check that the attributes have the correct shapes\n+        assert lrcv.C_.shape == (1,)  # Binary classification -> n_classes = 1\n+        assert lrcv.l1_ratio_.shape == (1,)\n+        assert lrcv.coef_.shape == (1, 3)  # (n_classes, n_features)\n+        assert lrcv.intercept_.shape == (1,)\n+\n+\n def test_LogisticRegressionCV_elasticnet_attribute_shapes():\n     # Make sure the shapes of scores_ and coefs_paths_ attributes are correct\n     # when using elasticnet (added one dimension for l1_ratios)\n"}