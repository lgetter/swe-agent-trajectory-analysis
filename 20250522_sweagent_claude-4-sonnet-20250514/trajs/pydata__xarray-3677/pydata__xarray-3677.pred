{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "pydata__xarray-3677", "model_patch": "diff --git a/xarray/core/merge.py b/xarray/core/merge.py\nindex 10c7804d..afe98155 100644\n--- a/xarray/core/merge.py\n+++ b/xarray/core/merge.py\n@@ -387,6 +387,9 @@ def coerce_pandas_values(objects: Iterable[\"CoercibleMapping\"]) -> List[\"Dataset\n     for obj in objects:\n         if isinstance(obj, Dataset):\n             variables: \"DatasetLike\" = obj\n+        elif isinstance(obj, DataArray):\n+            # Convert DataArray to Dataset\n+            variables = obj.to_dataset()\n         else:\n             variables = {}\n             if isinstance(obj, PANDAS_TYPES):\n@@ -805,6 +808,8 @@ def dataset_merge_method(\n ) -> _MergeResult:\n     \"\"\"Guts of the Dataset.merge method.\n     \"\"\"\n+    from .dataarray import DataArray\n+    \n     # we are locked into supporting overwrite_vars for the Dataset.merge\n     # method due for backwards compatibility\n     # TODO: consider deprecating it?\n@@ -817,6 +822,23 @@ def dataset_merge_method(\n     if not overwrite_vars:\n         objs = [dataset, other]\n         priority_arg = None\n+    elif isinstance(other, DataArray):\n+        # For DataArray, we can't use set(other) since DataArray doesn't support iteration\n+        # Convert to dataset and check if overwrite_vars matches the variable names\n+        other_as_dataset = other.to_dataset()\n+        if overwrite_vars == set(other_as_dataset):\n+            objs = [dataset, other]\n+            priority_arg = 1\n+        else:\n+            other_overwrite: Dict[Hashable, CoercibleValue] = {}\n+            other_no_overwrite: Dict[Hashable, CoercibleValue] = {}\n+            for k, v in other_as_dataset.items():\n+                if k in overwrite_vars:\n+                    other_overwrite[k] = v\n+                else:\n+                    other_no_overwrite[k] = v\n+            objs = [dataset, other_no_overwrite, other_overwrite]\n+            priority_arg = 2\n     elif overwrite_vars == set(other):\n         objs = [dataset, other]\n         priority_arg = 1\ndiff --git a/xarray/tests/test_merge.py b/xarray/tests/test_merge.py\nindex c1e6c7a5..ba4c2bd8 100644\n--- a/xarray/tests/test_merge.py\n+++ b/xarray/tests/test_merge.py\n@@ -253,3 +253,32 @@ class TestMergeMethod:\n         with pytest.raises(xr.MergeError):\n             ds3 = xr.Dataset({\"a\": (\"y\", [2, 3]), \"y\": [1, 2]})\n             ds1.merge(ds3, compat=\"no_conflicts\")\n+\n+    def test_merge_dataarray(self):\n+        # Test merging DataArray into Dataset using dataset method\n+        ds = xr.Dataset({\"a\": 0})\n+        da = xr.DataArray(1, name=\"b\")\n+        \n+        # Test basic merge\n+        expected = xr.merge([ds, da])\n+        actual = ds.merge(da)\n+        assert expected.identical(actual)\n+        \n+        # Test merge with coordinates\n+        ds_coords = xr.Dataset({\"a\": (\"x\", [1, 2, 3])}, coords={\"x\": [0, 1, 2]})\n+        da_coords = xr.DataArray([4, 5, 6], dims=[\"x\"], coords={\"x\": [0, 1, 2]}, name=\"b\")\n+        expected_coords = xr.merge([ds_coords, da_coords])\n+        actual_coords = ds_coords.merge(da_coords)\n+        assert expected_coords.identical(actual_coords)\n+        \n+        # Test merge with overwrite_vars\n+        ds_overwrite = xr.Dataset({\"a\": 0, \"b\": 10})\n+        da_overwrite = xr.DataArray(1, name=\"b\")\n+        expected_overwrite = xr.Dataset({\"a\": 0, \"b\": 1})\n+        actual_overwrite = ds_overwrite.merge(da_overwrite, overwrite_vars=[\"b\"])\n+        assert expected_overwrite.identical(actual_overwrite)\n+        \n+        # Test merge with unnamed DataArray should fail\n+        da_unnamed = xr.DataArray(1)\n+        with pytest.raises(ValueError, match=\"unable to convert unnamed DataArray\"):\n+            ds.merge(da_unnamed)\n"}