{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "sympy__sympy-14248", "model_patch": "diff --git a/sympy/printing/latex.py b/sympy/printing/latex.py\nindex 8253b2f682..f61f70737e 100644\n--- a/sympy/printing/latex.py\n+++ b/sympy/printing/latex.py\n@@ -1477,8 +1477,52 @@ def _print_Adjoint(self, expr):\n             return r\"%s^\\dagger\" % self._print(mat)\n \n     def _print_MatAdd(self, expr):\n+        def _matrix_coeff_isneg(arg):\n+            \"\"\"Return True if the leading coefficient of a matrix expression is negative.\"\"\"\n+            if hasattr(arg, 'is_MatMul') and arg.is_MatMul:\n+                coeff, matrices = arg.as_coeff_matrices()\n+                return coeff.is_Number and coeff.is_negative\n+            return False\n+        \n         terms = list(expr.args)\n-        tex = \" + \".join(map(self._print, terms))\n+        tex = \"\"\n+        for i, term in enumerate(terms):\n+            if i == 0:\n+                # Handle first term\n+                if _matrix_coeff_isneg(term):\n+                    tex += \"-\"\n+                    # Extract positive part for negative terms\n+                    coeff, matrices = term.as_coeff_matrices()\n+                    from sympy.matrices.expressions.matmul import MatMul\n+                    if -coeff == 1:\n+                        # If coefficient is -1, just print the matrices without the coefficient\n+                        if len(matrices) == 1:\n+                            term = matrices[0]\n+                        else:\n+                            term = MatMul(*matrices)\n+                    else:\n+                        term = MatMul(-coeff, *matrices)\n+            elif _matrix_coeff_isneg(term):\n+                tex += \" - \"\n+                # Extract positive part for negative terms\n+                coeff, matrices = term.as_coeff_matrices()\n+                from sympy.matrices.expressions.matmul import MatMul\n+                if -coeff == 1:\n+                    # If coefficient is -1, just print the matrices without the coefficient\n+                    if len(matrices) == 1:\n+                        term = matrices[0]\n+                    else:\n+                        term = MatMul(*matrices)\n+                else:\n+                    term = MatMul(-coeff, *matrices)\n+            else:\n+                tex += \" + \"\n+            \n+            term_tex = self._print(term)\n+            if self._needs_add_brackets(term):\n+                term_tex = r\"\\left(%s\\right)\" % term_tex\n+            tex += term_tex\n+        \n         return tex\n \n     def _print_MatMul(self, expr):\ndiff --git a/sympy/printing/pretty/pretty.py b/sympy/printing/pretty/pretty.py\nindex db24f4c612..1e80e8fbe1 100644\n--- a/sympy/printing/pretty/pretty.py\n+++ b/sympy/printing/pretty/pretty.py\n@@ -819,7 +819,49 @@ def _print_BlockMatrix(self, B):\n         return self._print(B.blocks)\n \n     def _print_MatAdd(self, expr):\n-        return self._print_seq(expr.args, None, None, ' + ')\n+        def _matrix_coeff_isneg(arg):\n+            \"\"\"Return True if the leading coefficient of a matrix expression is negative.\"\"\"\n+            if hasattr(arg, 'is_MatMul') and arg.is_MatMul:\n+                coeff, matrices = arg.as_coeff_matrices()\n+                return coeff.is_Number and coeff.is_negative\n+            return False\n+        \n+        pforms = []\n+        for i, term in enumerate(expr.args):\n+            if _matrix_coeff_isneg(term):\n+                # Extract positive part for negative terms\n+                coeff, matrices = term.as_coeff_matrices()\n+                from sympy.matrices.expressions.matmul import MatMul\n+                if -coeff == 1:\n+                    # If coefficient is -1, just print the matrices without the coefficient\n+                    if len(matrices) == 1:\n+                        positive_term = matrices[0]\n+                    else:\n+                        positive_term = MatMul(*matrices)\n+                else:\n+                    positive_term = MatMul(-coeff, *matrices)\n+                pform = self._print(positive_term)\n+                \n+                # Add minus sign\n+                if i == 0:\n+                    if pform.height() > 1:\n+                        pform_neg = '- '\n+                    else:\n+                        pform_neg = '-'\n+                else:\n+                    pform_neg = ' - '\n+                \n+                if (pform.binding > prettyForm.NEG\n+                    or pform.binding == prettyForm.ADD):\n+                    p = stringPict(*pform.parens())\n+                else:\n+                    p = pform\n+                p = stringPict.next(pform_neg, p)\n+                pforms.append(prettyForm(binding=prettyForm.NEG, *p))\n+            else:\n+                pforms.append(self._print(term))\n+        \n+        return prettyForm.__add__(*pforms)\n \n     def _print_MatMul(self, expr):\n         args = list(expr.args)\ndiff --git a/sympy/printing/str.py b/sympy/printing/str.py\nindex 0baefe0f7f..73145255ff 100644\n--- a/sympy/printing/str.py\n+++ b/sympy/printing/str.py\n@@ -312,8 +312,43 @@ def _print_HadamardProduct(self, expr):\n             for arg in expr.args])\n \n     def _print_MatAdd(self, expr):\n-        return ' + '.join([self.parenthesize(arg, precedence(expr))\n-            for arg in expr.args])\n+        def _matrix_coeff_isneg(arg):\n+            \"\"\"Return True if the leading coefficient of a matrix expression is negative.\"\"\"\n+            if hasattr(arg, 'is_MatMul') and arg.is_MatMul:\n+                coeff, matrices = arg.as_coeff_matrices()\n+                return coeff.is_Number and coeff.is_negative\n+            return False\n+        \n+        PREC = precedence(expr)\n+        l = []\n+        for term in expr.args:\n+            if _matrix_coeff_isneg(term):\n+                # Extract positive part for negative terms\n+                coeff, matrices = term.as_coeff_matrices()\n+                from sympy.matrices.expressions.matmul import MatMul\n+                if -coeff == 1:\n+                    # If coefficient is -1, just print the matrices without the coefficient\n+                    if len(matrices) == 1:\n+                        positive_term = matrices[0]\n+                    else:\n+                        positive_term = MatMul(*matrices)\n+                else:\n+                    positive_term = MatMul(-coeff, *matrices)\n+                t = self._print(positive_term)\n+                sign = \"-\"\n+            else:\n+                t = self._print(term)\n+                sign = \"+\"\n+            \n+            if precedence(term) < PREC:\n+                l.extend([sign, \"(%s)\" % t])\n+            else:\n+                l.extend([sign, t])\n+        \n+        sign = l.pop(0)\n+        if sign == '+':\n+            sign = \"\"\n+        return sign + ' '.join(l)\n \n     def _print_NaN(self, expr):\n         return 'nan'\ndiff --git a/sympy/printing/tests/test_latex.py b/sympy/printing/tests/test_latex.py\nindex 0f07d5e3a9..414357384f 100644\n--- a/sympy/printing/tests/test_latex.py\n+++ b/sympy/printing/tests/test_latex.py\n@@ -1710,7 +1710,7 @@ def test_MatrixElement_printing():\n     assert latex(3 * A[0, 0]) == r\"3 A_{0, 0}\"\n \n     F = C[0, 0].subs(C, A - B)\n-    assert latex(F) == r\"\\left(-1 B + A\\right)_{0, 0}\"\n+    assert latex(F) == r\"\\left(-B + A\\right)_{0, 0}\"\n \n \n def test_Quaternion_latex_printing():\ndiff --git a/sympy/printing/tests/test_str.py b/sympy/printing/tests/test_str.py\nindex 884c09d941..a65dc1d34e 100644\n--- a/sympy/printing/tests/test_str.py\n+++ b/sympy/printing/tests/test_str.py\n@@ -784,4 +784,4 @@ def test_MatrixElement_printing():\n     assert(str(3 * A[0, 0]) == \"3*A[0, 0]\")\n \n     F = C[0, 0].subs(C, A - B)\n-    assert str(F) == \"((-1)*B + A)[0, 0]\"\n+    assert str(F) == \"(-B + A)[0, 0]\"\n"}