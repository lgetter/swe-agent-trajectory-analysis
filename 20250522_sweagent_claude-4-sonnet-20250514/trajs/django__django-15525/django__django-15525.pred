{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "django__django-15525", "model_patch": "diff --git a/django/core/serializers/base.py b/django/core/serializers/base.py\nindex da85cb4b92..6e7f9a8fc2 100644\n--- a/django/core/serializers/base.py\n+++ b/django/core/serializers/base.py\n@@ -336,14 +336,21 @@ def build_instance(Model, data, db):\n         and hasattr(default_manager, \"get_by_natural_key\")\n         and hasattr(Model, \"natural_key\")\n     ):\n-        natural_key = Model(**data).natural_key()\n+        instance = Model(**data)\n+        # Set the database state so that foreign key lookups in natural_key()\n+        # use the correct database.\n+        instance._state.db = db\n+        natural_key = instance.natural_key()\n         try:\n             data[Model._meta.pk.attname] = Model._meta.pk.to_python(\n                 default_manager.db_manager(db).get_by_natural_key(*natural_key).pk\n             )\n         except Model.DoesNotExist:\n             pass\n-    return Model(**data)\n+    instance = Model(**data)\n+    # Set the database state on the final instance as well\n+    instance._state.db = db\n+    return instance\n \n \n def deserialize_m2m_values(field, field_value, using, handle_forward_references):\n"}