{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "sympy__sympy-23413", "model_patch": "diff --git a/sympy/polys/matrices/normalforms.py b/sympy/polys/matrices/normalforms.py\nindex 30f5534b08..d4baf27288 100644\n--- a/sympy/polys/matrices/normalforms.py\n+++ b/sympy/polys/matrices/normalforms.py\n@@ -233,9 +233,15 @@ def _hermite_normal_form(A):\n             b = -b\n         # The pivot entry will be 0 iff the row was 0 from the pivot col all the\n         # way to the left. In this case, we are still working on the same pivot\n-        # col for the next row. Therefore:\n+        # col for the next row. However, we should check if there are non-zero\n+        # entries in unprocessed rows that would be lost.\n         if b == 0:\n-            k += 1\n+            # Check if there are non-zero entries in unprocessed rows in this column\n+            # But only preserve the column if we've found at least one pivot so far\n+            has_nonzero_in_unprocessed = any(A[ii][k] != 0 for ii in range(m - rows))\n+            has_found_pivot = k < n - 1  # We've moved k from n, so if k < n-1, we found a pivot\n+            if not (has_nonzero_in_unprocessed and has_found_pivot):\n+                k += 1\n         # If the pivot entry is nonzero, then we want to reduce all entries to its\n         # right in the sense of the division algorithm, i.e. make them all remainders\n         # w.r.t. the pivot as divisor.\n"}