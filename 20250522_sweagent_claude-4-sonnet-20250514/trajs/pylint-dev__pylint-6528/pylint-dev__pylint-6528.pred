{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "pylint-dev__pylint-6528", "model_patch": "diff --git a/pylint/lint/pylinter.py b/pylint/lint/pylinter.py\nindex 53345a6b1..f008ec3c3 100644\n--- a/pylint/lint/pylinter.py\n+++ b/pylint/lint/pylinter.py\n@@ -31,7 +31,7 @@ from pylint.constants import (\n )\n from pylint.lint.base_options import _make_linter_options\n from pylint.lint.caching import load_results, save_results\n-from pylint.lint.expand_modules import expand_modules\n+from pylint.lint.expand_modules import expand_modules, _is_in_ignore_list_re\n from pylint.lint.message_state_handler import _MessageStateHandler\n from pylint.lint.parallel import check_parallel\n from pylint.lint.report_functions import (\n@@ -564,13 +564,25 @@ class PyLinter(\n             if not msg.may_be_emitted():\n                 self._msgs_state[msg.msgid] = False\n \n-    @staticmethod\n-    def _discover_files(files_or_modules: Sequence[str]) -> Iterator[str]:\n+    def _discover_files(self, files_or_modules: Sequence[str]) -> Iterator[str]:\n         \"\"\"Discover python modules and packages in sub-directory.\n \n         Returns iterator of paths to discovered modules and packages.\n         \"\"\"\n         for something in files_or_modules:\n+            # Check if the top-level item should be ignored\n+            basename = os.path.basename(something)\n+            # Normalize the path for ignore_paths matching\n+            normalized_something = os.path.normpath(something)\n+            if normalized_something.startswith('./'):\n+                normalized_something = normalized_something[2:]\n+            if (\n+                basename in self.config.ignore\n+                or _is_in_ignore_list_re(basename, self.config.ignore_patterns)\n+                or _is_in_ignore_list_re(normalized_something, self.config.ignore_paths)\n+            ):\n+                continue\n+                \n             if os.path.isdir(something) and not os.path.isfile(\n                 os.path.join(something, \"__init__.py\")\n             ):\n@@ -579,15 +591,59 @@ class PyLinter(\n                     if any(root.startswith(s) for s in skip_subtrees):\n                         # Skip subtree of already discovered package.\n                         continue\n+                    \n+                    # Check if this directory should be ignored\n+                    root_basename = os.path.basename(root)\n+                    # Normalize the root path for ignore_paths matching\n+                    normalized_root = os.path.normpath(root)\n+                    if normalized_root.startswith('./'):\n+                        normalized_root = normalized_root[2:]\n+                    \n+                    # Check if any part of the path should be ignored\n+                    should_ignore = False\n+                    \n+                    # Check basename against ignore list and patterns\n+                    if (root_basename in self.config.ignore\n+                        or _is_in_ignore_list_re(root_basename, self.config.ignore_patterns)):\n+                        should_ignore = True\n+                    \n+                    # Check full path against ignore_paths\n+                    if _is_in_ignore_list_re(normalized_root, self.config.ignore_paths):\n+                        should_ignore = True\n+                    \n+                    # Check if any parent directory is in the ignore list\n+                    if not should_ignore:\n+                        path_parts = normalized_root.split(os.sep)\n+                        for part in path_parts:\n+                            if (part in self.config.ignore\n+                                or _is_in_ignore_list_re(part, self.config.ignore_patterns)):\n+                                should_ignore = True\n+                                break\n+                    \n+                    if should_ignore:\n+                        continue\n+                    \n                     if \"__init__.py\" in files:\n                         skip_subtrees.append(root)\n                         yield root\n                     else:\n-                        yield from (\n-                            os.path.join(root, file)\n-                            for file in files\n-                            if file.endswith(\".py\")\n-                        )\n+                        for file in files:\n+                            if file.endswith(\".py\"):\n+                                # Check if this file should be ignored\n+                                file_basename = os.path.splitext(file)[0]  # Remove .py extension for basename check\n+                                filepath = os.path.join(root, file)\n+                                # Normalize the filepath for ignore_paths matching\n+                                normalized_filepath = os.path.normpath(filepath)\n+                                if normalized_filepath.startswith('./'):\n+                                    normalized_filepath = normalized_filepath[2:]\n+                                \n+                                if (\n+                                    file_basename in self.config.ignore\n+                                    or _is_in_ignore_list_re(file_basename, self.config.ignore_patterns)\n+                                    or _is_in_ignore_list_re(normalized_filepath, self.config.ignore_paths)\n+                                ):\n+                                    continue\n+                                yield filepath\n             else:\n                 yield something\n \n@@ -959,7 +1015,7 @@ class PyLinter(\n                 self.config.extension_pkg_whitelist\n             )\n         self.stats.reset_message_count()\n-        self._ignore_paths = self.linter.config.ignore_paths\n+        self._ignore_paths = self.config.ignore_paths\n \n     def generate_reports(self) -> int | None:\n         \"\"\"Close the whole package /module, it's time to make reports !\n"}