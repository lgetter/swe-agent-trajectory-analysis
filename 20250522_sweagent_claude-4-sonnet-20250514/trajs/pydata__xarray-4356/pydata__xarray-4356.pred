{"model_name_or_path": "250522_anthropic_filemap_simple_review__claude-sonnet-4-20250514__t-0.00__p-1.00__c-3.00___swe_bench_verified_test", "instance_id": "pydata__xarray-4356", "model_patch": "diff --git a/xarray/core/nanops.py b/xarray/core/nanops.py\nindex 41c8d258..2fcac65a 100644\n--- a/xarray/core/nanops.py\n+++ b/xarray/core/nanops.py\n@@ -26,17 +26,23 @@ def _maybe_null_out(result, axis, mask, min_count=1):\n     \"\"\"\n     xarray version of pandas.core.nanops._maybe_null_out\n     \"\"\"\n-    if hasattr(axis, \"__len__\"):  # if tuple or list\n-        raise ValueError(\n-            \"min_count is not available for reduction with more than one dimensions.\"\n-        )\n-\n-    if axis is not None and getattr(result, \"ndim\", False):\n-        null_mask = (mask.shape[axis] - mask.sum(axis) - min_count) < 0\n+    if axis is not None and hasattr(result, \"ndim\"):\n+        # Calculate total number of elements along the specified axis/axes\n+        if hasattr(axis, \"__len__\"):  # if tuple or list (multiple axes)\n+            total_elements = np.take(mask.shape, axis).prod()\n+        else:  # single axis\n+            total_elements = mask.shape[axis]\n+        \n+        null_mask = (total_elements - mask.sum(axis) - min_count) < 0\n         if null_mask.any():\n             dtype, fill_value = dtypes.maybe_promote(result.dtype)\n             result = result.astype(dtype)\n-            result[null_mask] = fill_value\n+            if result.ndim == 0:\n+                # Scalar result - replace the entire value\n+                result = fill_value\n+            else:\n+                # Array result - replace elements where null_mask is True\n+                result[null_mask] = fill_value\n \n     elif getattr(result, \"dtype\", None) not in dtypes.NAT_TYPES:\n         null_mask = mask.size - mask.sum()\n"}